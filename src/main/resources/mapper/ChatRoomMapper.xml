<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.project.mapper.ChatRoomMapper">
	<insert id="insertChatRoom" parameterType="com.project.domain.ChatRoom">
	    INSERT INTO chat_rooms (
	        member_id, room_name, location, max_participants, min_participants,
	        theme, recruitment_duration, recruitment_deadline, additional_description, password, status, created_at
	    ) VALUES (
	        #{memberId, jdbcType=NUMERIC},
	        #{roomName, jdbcType=VARCHAR},
	        #{location, jdbcType=VARCHAR},
	        #{maxParticipants, jdbcType=NUMERIC},
	        #{minParticipants, jdbcType=NUMERIC},
	        #{theme, jdbcType=VARCHAR},
	        #{recruitmentDuration, jdbcType=NUMERIC},
	        CASE
	            WHEN #{recruitmentDuration} IS NOT NULL THEN
	                SYSDATE + NUMTODSINTERVAL(#{recruitmentDuration}, 'MINUTE')
	            ELSE NULL
	        END,
	        #{additionalDescription, jdbcType=VARCHAR},
	        #{password, jdbcType=VARCHAR},
	        #{status, jdbcType=VARCHAR},
	        SYSDATE
	    )
	</insert>
		
	<select id="getAllChatRooms" resultType="com.project.domain.ChatRoom">
	    SELECT * FROM chat_rooms ORDER BY created_at DESC
	</select>
  </mapper>
  